## Microblocks
![allScripts68967](https://user-images.githubusercontent.com/112697142/190081399-8f536d37-68ef-43c9-9c34-d640358862f6.png)



##### You can access the Microblocks codes of the project by dragging the image to the Microblocks Run tab or clicking [here](https://microblocks.fun/run/microblocks.html#scripts=GP%20Scripts%0A%0Aspec%20%27r%27%20%27ESP01_IP_address%27%20%27ESP01_IP_address%27%0Ato%20ESP01_IP_address%20%7B%0A%20%20waitUntil%20%280%20%3D%3D%20%28size%20%28%27%5Bserial%3Aread%5D%27%29%29%29%0A%20%20repeatUntil%20%28%27OK%27%20%3D%3D%20ESP01_status%29%20%7B%0A%20%20%20%20comment%20%27Obtain%20the%20station%20IP%20address%27%0A%20%20%20%20%27%5Bserial%3Awrite%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%27AT%2BCIPSTA%3F%27%20_eol%29%0A%20%20%20%20waitUntil%20ESP01_response%0A%20%20%7D%0A%20%20%27%5Bdata%3AaddLast%5D%27%20%27IP%20ok.%27%20ESP01_Log%0A%20%20return%20%28%27_byteArray2string%27%20%28%27%5Bdata%3AcopyFromTo%5D%27%20savebuffer%20%28%28%27%5Bdata%3Afind%5D%27%20%27STA%3Aip%3A%22%27%20savebuffer%29%20%2B%208%29%20%28%28%27%5Bdata%3Afind%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%27%22%27%20_eol%29%20savebuffer%29%20-%201%29%29%29%0A%20%20waitMillis%20_espDelay%0A%7D%0A%0Aspec%20%27%20%27%20%27ESP01_connect_to%27%20%27ESP01_connect_to%20_%20Password%20_%27%20%27auto%20auto%27%20%27Network_Name%27%20%27Network_Password%27%0Ato%20ESP01_connect_to%20ssid%20password%20%7B%0A%20%20waitUntil%20%280%20%3D%3D%20%28size%20%28%27%5Bserial%3Aread%5D%27%29%29%29%0A%20%20ESP01_ssid%20%3D%20ssid%0A%20%20ESP01_password%20%3D%20password%0A%20%20repeatUntil%20%28%27OK%27%20%3D%3D%20ESP01_status%29%20%7B%0A%20%20%20%20comment%20%27Connect%20to%20an%20AP%27%0A%20%20%20%20%27%5Bserial%3Awrite%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%27AT%2BCWJAP%3D%22%27%20ssid%20%27%22%2C%22%27%20password%20%27%22%27%20_eol%29%0A%20%20%20%20waitUntil%20%28%28%27%5Bdata%3Afind%5D%27%20%27WIFI%20CONNECTED%27%20_serbuffer%29%20%21%3D%20-1%29%0A%20%20%20%20waitUntil%20%28%28%27%5Bdata%3Afind%5D%27%20%27WIFI%20GOT%20IP%27%20_serbuffer%29%20%21%3D%20-1%29%0A%20%20%20%20waitUntil%20ESP01_response%0A%20%20%7D%0A%20%20waitMillis%20_espDelay%0A%20%20comment%20%27Obtain%20the%20local%20IP%20address%20and%20MAC%20address%27%0A%20%20ESP01_IPaddr%20%3D%20%28ESP01_IP_address%29%0A%20%20waitMillis%20_espDelay%0A%20%20%27%5Bdata%3AaddLast%5D%27%20%27CONNECT%20ok.%27%20ESP01_Log%0A%20%20waitMillis%20_espDelay%0A%7D%0A%0Aspec%20%27r%27%20%27ESP01_display_LOG2%27%20%27ESP01_display_LOG%27%0Ato%20ESP01_display_LOG2%20%7B%0A%20%20return%20%28%27%5Bdata%3AjoinStrings%5D%27%20ESP01_Log%20_eol%29%0A%7D%0A%0Aspec%20%27r%27%20%27ESP01_path_of_request%27%20%27ESP01_path_of_request%20_%27%20%27auto%27%20%27%27%0Ato%20ESP01_path_of_request%20request%20%7B%0A%20%20return%20%28%27_byteArray2string%27%20%28%27%5Bdata%3AcopyFromTo%5D%27%20request%20%28%28%27%5Bdata%3Afind%5D%27%20%27GET%20%27%20request%29%20%2B%204%29%20%28%28%27%5Bdata%3Afind%5D%27%20%27%20HTTP%27%20request%29%20-%201%29%29%29%0A%7D%0A%0Aspec%20%27%20%27%20%27ESP01_restore%27%20%27ESP01_restore%27%0Ato%20ESP01_restore%20%7B%0A%20%20waitUntil%20%280%20%3D%3D%20%28size%20%28%27%5Bserial%3Aread%5D%27%29%29%29%0A%20%20repeatUntil%20%28%27OK%27%20%3D%3D%20ESP01_status%29%20%7B%0A%20%20%20%20comment%20%27Restores%20the%20factory%20default%20settings%20of%20the%20module%27%0A%20%20%20%20%27%5Bserial%3Awrite%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%27AT%2BRESTORE%27%20_eol%29%0A%20%20%20%20waitUntil%20ESP01_response%0A%20%20%7D%0A%20%20%27%5Bdata%3AaddLast%5D%27%20%27RESTORE%20ok.%27%20ESP01_Log%0A%20%20waitMillis%20_espDelay%0A%7D%0A%0Aspec%20%27%20%27%20%27ESP01_server%27%20%27ESP01_server%20_%27%20%27str.ServerMenu%27%20%27Create%20Server%27%0Ato%20ESP01_server%20action%20%7B%0A%20%20waitUntil%20%280%20%3D%3D%20%28size%20%28%27%5Bserial%3Aread%5D%27%29%29%29%0A%20%20if%20%28%27Delete%20Server%27%20%3D%3D%20action%29%20%7B%0A%20%20%20%20action%20%3D%200%0A%20%20%20%20local%20%27param%27%201%0A%20%20%7D%20%28%27Create%20Server%27%20%3D%3D%20action%29%20%7B%0A%20%20%20%20action%20%3D%201%0A%20%20%20%20local%20%27param%27%2080%0A%20%20%7D%0A%20%20ESP01_set_MUX%201%0A%20%20repeatUntil%20%28%27OK%27%20%3D%3D%20ESP01_status%29%20%7B%0A%20%20%20%20comment%20%27Delete%2Fcreate%20a%20TCP%2FSSL%20server%27%0A%20%20%20%20%27%5Bserial%3Awrite%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%27AT%2BCIPSERVER%3D%27%20action%20%27%2C%27%20param%20_eol%29%0A%20%20%20%20waitUntil%20ESP01_response%0A%20%20%7D%0A%20%20%27%5Bdata%3AaddLast%5D%27%20%27SERVER%20ok.%27%20ESP01_Log%0A%20%20waitMillis%20_espDelay%0A%7D%0A%0Aspec%20%27%20%27%20%27ESP01_set_MUX%27%20%27ESP01_set_MUX%20_%27%20%27str.MuxMenu%27%20%27Multiple%20Connections%27%0Ato%20ESP01_set_MUX%20mux%20%7B%0A%20%20waitUntil%20%280%20%3D%3D%20%28size%20%28%27%5Bserial%3Aread%5D%27%29%29%29%0A%20%20if%20%28%27Single%20Connection%27%20%3D%3D%20mux%29%20%7B%0A%20%20%20%20mux%20%3D%200%0A%20%20%7D%20%28%27Multiple%20Connections%27%20%3D%3D%20mux%29%20%7B%0A%20%20%20%20mux%20%3D%201%0A%20%20%7D%0A%20%20repeatUntil%20%28%27OK%27%20%3D%3D%20ESP01_status%29%20%7B%0A%20%20%20%20comment%20%27Enable%2Fdisable%20the%20multiple%20connections%20mode%27%0A%20%20%20%20%27%5Bserial%3Awrite%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%27AT%2BCIPMUX%3D%27%20mux%20_eol%29%0A%20%20%20%20waitUntil%20ESP01_response%0A%20%20%7D%0A%20%20%27%5Bdata%3AaddLast%5D%27%20%27MUX%20ok.%27%20ESP01_Log%0A%20%20waitMillis%20_espDelay%0A%7D%0A%0Aspec%20%27%20%27%20%27ESP01_set_WIFI_mode%27%20%27ESP01_set_WIFI_mode%20_%27%20%27str.ModeMenu%27%20%27Station%27%0Ato%20ESP01_set_WIFI_mode%20mode%20%7B%0A%20%20waitUntil%20%280%20%3D%3D%20%28size%20%28%27%5Bserial%3Aread%5D%27%29%29%29%0A%20%20if%20%28%27Station%27%20%3D%3D%20mode%29%20%7B%0A%20%20%20%20mode%20%3D%201%0A%20%20%7D%20%28%27SoftAP%27%20%3D%3D%20mode%29%20%7B%0A%20%20%20%20mode%20%3D%202%0A%20%20%7D%20%28%27Station%26SoftAP%27%20%3D%3D%20mode%29%20%7B%0A%20%20%20%20mode%20%3D%203%0A%20%20%7D%0A%20%20repeatUntil%20%28%27OK%27%20%3D%3D%20ESP01_status%29%20%7B%0A%20%20%20%20comment%20%27Set%20the%20Wi-Fi%20mode%20%28Station%2FSoftAP%2FStation%2BSoftAP%29%27%0A%20%20%20%20%27%5Bserial%3Awrite%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%27AT%2BCWMODE%3D%27%20mode%20_eol%29%0A%20%20%20%20waitUntil%20ESP01_response%0A%20%20%7D%0A%20%20%27%5Bdata%3AaddLast%5D%27%20%27WIFI%20Mode%20ok.%27%20ESP01_Log%0A%20%20waitMillis%20_espDelay%0A%7D%0A%0Aspec%20%27r%27%20%27_byteArray2string%27%20%27_byteArray2string%20_%27%20%27auto%27%20%27%27%0Ato%20%27_byteArray2string%27%20aStringOrByteArray%20%7B%0A%20%20comment%20%27If%20argument%20is%20a%20byte%20array%2C%20convert%20it%20to%20a%20string.%20%27%0A%20%20if%20%28not%20%28isType%20aStringOrByteArray%20%27string%27%29%29%20%7B%0A%20%20%20%20aStringOrByteArray%20%3D%20%28%27%5Bdata%3Ajoin%5D%27%20%27%27%20aStringOrByteArray%29%0A%20%20%7D%0A%20%20return%20aStringOrByteArray%0A%7D%0A%0Aspec%20%27%20%27%20%27_handleIPD%27%20%27_handleIPD%27%0Ato%20%27_handleIPD%27%20%7B%0A%20%20_request%20%3D%20%28%27%5Bdata%3AcopyFromTo%5D%27%20_serbuffer%20%28%27%5Bdata%3Afind%5D%27%20%27%2BIPD%27%20_serbuffer%29%29%0A%20%20local%20%27linkPtr%27%20%28%28%27%5Bdata%3Afind%5D%27%20%27%2BIPD%2C%27%20_request%29%20%2B%205%29%0A%20%20_linkID%20%3D%20%28%27%5Bdata%3AcopyFromTo%5D%27%20_request%20linkPtr%20%28%28%27%5Bdata%3Afind%5D%27%20_comma%20_request%20linkPtr%29%20-%201%29%29%0A%20%20for%20response%20responses%20%7B%0A%20%20%20%20if%20%28%28ESP01_path_of_request%20_request%29%20%3D%3D%20%28at%201%20response%29%29%20%7B%0A%20%20%20%20%20%20processRequest%0A%20%20%20%20%20%20comment%20%27Following%20is%20a%20TCP%20messaging%20sequence%20to%20send%20back%20any%20feedback%20desired.%27%0A%20%20%20%20%20%20%27%5Bdata%3AaddLast%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%28ESP01_path_of_request%20_request%29%20%27%20processed.%27%29%20ESP01_Log%0A%20%20%20%20%20%20%27%5Bserial%3Awrite%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%27AT%2BCIPSEND%3D%27%20_linkID%20_comma%20%28size%20%28at%202%20response%29%29%20_eol%29%0A%20%20%20%20%20%20waitMillis%20_espDelay%0A%20%20%20%20%20%20%27%5Bserial%3Awrite%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%28at%202%20response%29%20_eol%29%0A%20%20%20%20%20%20waitMillis%20_espDelay%0A%20%20%20%20%20%20%27%5Bserial%3Awrite%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%27AT%2BCIPCLOSE%3D%27%20_linkID%20_eol%29%0A%20%20%20%20%20%20waitMillis%20_espDelay%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%0Aspec%20%27%20%27%20%27initializeResponses%27%20%27initializeResponses%27%0Ato%20initializeResponses%20%7B%0A%20%20comment%20%27APP%20Inventor%20APP%20processes%202%20kinds%20of%20responses%20from%20this%20program%3A%0A1.%20Web%20Page%20displays%20of%20info%0A2.%20JSON%20data%20sent%20in%20response%20to%20HTTP%20GET%20%2FSERA%20transaction%0A%0A%231%20type%20responses%20are%20processed%20in%20the%20WebViewer%20component%20and%20%0Ado%20not%20require%20a%20header%20info.%0A%0A%232%20type%20responses%20are%20true%20responses%20to%20HTTP%20GET%20and%20require%20%0Aa%20proper%20header%3A%0A%20%20%20%20HTTP%2F1.1%20200%20OK%5CnContent-Type%3A%20text%2Fhtml%5Cn%5Cn%20is%20%0A%0ANOTE%3A%20timeout%20delay%20for%20the%20HTTTP%20GET%20has%20to%20be%20long%20enough%20%0A%20%20%20%20%20%20%20%20%20%20%20%20to%20receive%20and%20process%20the%20data.%20Current%20setting%20is%2010000ms.%0A%20%20%20%20%20%20%20%20%20%20%20%20However%2C%20if%20more%20data%20is%20sent%20than%20the%20example%2C%20it%20might%20need%0A%20%20%20%20%20%20%20%20%20%20%20%20extending.%27%0A%20%20responses%20%3D%20%28%27%5Bdata%3AmakeList%5D%27%20%28%27%5Bdata%3AmakeList%5D%27%20%27%2F%27%20%27%3CH1%3ECONNECTED...%3Cbr%2F%3E%3C%2FH1%3E%0A%0A%3Cp%3EINFO%3A%20Temp%2C%20Humidity%2C%20Soil%20Moisture%3Cbr%2F%3E%0A%0AWATERING%3A%20Run%20Water%20Pump%3Cbr%2F%3E%0A%0A%3C%2Fp%3E%27%29%20%28%27%5Bdata%3AmakeList%5D%27%20%27%2FSERA%27%20%28%27%5Bdata%3Ajoin%5D%27%20%28%27%5Bdata%3Ajoin%5D%27%20%27HTTP%2F1.1%20200%20OK%27%20_eol%20%27Content-Type%3A%20text%2Fhtml%27%20_eol%20_eol%29%20%27%7B%22TEMP%22%3A%27%20%28pb_temperature%29%20%27%2C%22S.Moisture%22%3A%27%20%28%28%28analogReadOp%2027%29%20%2F%201023%29%20%2A%20100%29%20%27%2C%22Humidity%22%3A%27%20%28pb_humidity%29%20%27%7D%27%29%29%20%28%27%5Bdata%3AmakeList%5D%27%20%27%2FWATERING%27%20%27%3CH1%3ESERA%20CONTROL%3Cbr%2F%3E%3C%2FH1%3E%0A%3Cp%3Eirrigation%20is%20complete..%3C%2Fp%3E%27%29%29%0A%7D%0A%0Aspec%20%27%20%27%20%27processRequest%27%20%27processRequest%27%0Ato%20processRequest%20%7B%0A%20%20comment%20%27Here%20is%20where%20all%20the%20program%20actions%20are%20evaluated%20and%20implemented.%0AProvide%20processing%20code%20for%20each%20function%20with%20its%20specific%20evaluation.%0AIf%20the%20activity%20code%20is%20too%20long%20%2F%20large%2C%20then%20provide%20a%20call%20to%20a%20custom%20function.%27%0A%20%20if%20%28%28ESP01_path_of_request%20_request%29%20%3D%3D%20%27%2FWATERING%27%29%20%7B%0A%20%20%20%20pb_set_motor_speed%201%20100%0A%20%20%20%20waitMillis%2010000%0A%20%20%20%20pb_set_motor_speed%201%200%0A%20%20%7D%0A%7D%0A%0Ascript%20477%20101%20%7B%0Acomment%20%27PicoBricks%20ESP01%20SERA%20Demo%0A%0AThis%20program%20demonstrates%20the%20interaction%20between%20an%20IP%20server%20created%20on%20the%20ESP01%20%0Aand%20a%20mobile%20APP%20to%20control%20SERA%20operations%20and%20retrieve%20data.%20It%20can%20be%20tested%20from%20a%20browser.%0A%0A-%20Set%20the%20SSID%20and%20PASSWD%20in%20the%20ESP01_connect_to%20block.%0A-%20Click%20on%20RUN%0A-%20Wait%20until%20the%20SERVER%20Ready%20message%20is%20displayed.%0A-%20Make%20a%20note%20of%20the%20SERVER%20IP%20displayed%20and%20submit%20your%20transactions.%0A%0ANow%20you%20can%20start%20testing.%0A%0ASubmitting%20the%20IP%20address%20in%20a%20browser%20session%20will%20display%20the%20menu%20of%20options%0ASubmitting%20IPaddress%2FSERA%20will%20obtain%20SERA%20values%20for%20Temperature%2C%20Humidity%2C%20and%20Light%20Level.%0A%0AAll%20activity%20is%20logged.%20Use%20ESP01_display_LOG%20block%20to%20see%20the%20contents%20of%20the%20log.%0A%0AENJOY.%0A%27%0A%7D%0A%0Ascript%201002%20446%20%7B%0AwhenBroadcastReceived%20%27COMM%20Loop%27%0AsayIt%20%27COMM%20Loop%20started.%27%0AwaitMillis%20_espDelay%0AinitializeResponses%0A_serbuffer%20%3D%20%27%27%0Aforever%20%7B%0A%20%20ESP01_status%20%3D%20%27%27%0A%20%20ESP01_response%20%3D%20%28booleanConstant%20false%29%0A%20%20_serbuffer%20%3D%20%28%27%5Bdata%3AasByteArray%5D%27%20%28%27%5Bserial%3Aread%5D%27%29%29%0A%20%20waitMillis%20_espDelay%0A%20%20if%20%28%28size%20_serbuffer%29%20%3E%200%29%20%7B%0A%20%20%20%20_serbuffer%20%3D%20%28%27_byteArray2string%27%20_serbuffer%29%0A%20%20%20%20comment%20%27Parse%20Request%20and%20Responses%20per%20_serBuffer%27%0A%20%20%20%20if%20%28%28%27%5Bdata%3Afind%5D%27%20%27%2BIPD%27%20_serbuffer%29%20%21%3D%20-1%29%20%7B%0A%20%20%20%20%20%20ESP01_status%20%3D%20%27DATA%27%0A%20%20%20%20%20%20savebuffer%20%3D%20_serbuffer%0A%20%20%20%20%20%20ESP01_response%20%3D%20%28booleanConstant%20true%29%0A%20%20%20%20%20%20%27_handleIPD%27%0A%20%20%20%20%7D%20%28%28%27%5Bdata%3Afind%5D%27%20%27OK%27%20_serbuffer%29%20%21%3D%20-1%29%20%7B%0A%20%20%20%20%20%20ESP01_status%20%3D%20%27OK%27%0A%20%20%20%20%20%20savebuffer%20%3D%20_serbuffer%0A%20%20%20%20%20%20ESP01_response%20%3D%20%28booleanConstant%20true%29%0A%20%20%20%20%7D%20%28%28%27%5Bdata%3Afind%5D%27%20%27ERROR%27%20_serbuffer%29%20%21%3D%20-1%29%20%7B%0A%20%20%20%20%20%20%27%5Bdata%3AaddLast%5D%27%20%27ERROR%20while%20processing.%27%20ESP01_Log%0A%20%20%20%20%20%20ESP01_status%20%3D%20%27ERROR%27%0A%20%20%20%20%20%20savebuffer%20%3D%20_serbuffer%0A%20%20%20%20%20%20ESP01_response%20%3D%20%28booleanConstant%20true%29%0A%20%20%20%20%7D%0A%20%20%7D%0A%7D%0A%7D%0A%0Ascript%20480%20448%20%7B%0AwhenStarted%0Alocal%20%27delay%27%2050%0Arepeat%209%20%7B%0A%20%20setUserLED%20true%0A%20%20waitMillis%20delay%0A%20%20setUserLED%20false%0A%20%20waitMillis%20delay%0A%7D%0A_espDelay%20%3D%203000%0A_eol%20%3D%20%28%27%5Bdata%3Ajoin%5D%27%20%28%27%5Bdata%3AunicodeString%5D%27%2013%29%20%28%27%5Bdata%3AunicodeString%5D%27%2010%29%29%0A_colon%20%3D%20%28%27%5Bdata%3AunicodeString%5D%27%2058%29%0A_comma%20%3D%20%28%27%5Bdata%3AunicodeString%5D%27%2044%29%0AESP01_Log%20%3D%20%28%27%5Bdata%3AmakeList%5D%27%29%0A%27%5Bserial%3Aopen%5D%27%20115200%0AsendBroadcast%20%27COMM%20Loop%27%0AsayIt%20%27Preparing%20SERVER%20setup.%0APlease%20wait%20till%20next%20prompt.%27%0AESP01_restore%0AESP01_set_WIFI_mode%20%27Station%27%0AESP01_connect_to%20%27yourWifiSSID%27%20%27YourWifiPassword%27%0AESP01_server%20%27Create%20Server%27%0AsayIt%20%27SERVER%20Ready%20for%20transactions.%27%20_eol%20%27Open%20a%20browser%20tab%20and%20%27%20_eol%20%27%20%20use%20IP%3A%27%20ESP01_IPaddr%20_eol%0A%7D%0A%0Ascript%20755%20481%20%28ESP01_display_LOG2%29%0A%0Ascript%201387%20770%20%7B%0AsayIt%20%27Buffer%20Len%3A%27%20%28size%20_serbuffer%29%20_eol%20_serbuffer%0A%7D%0A%0Ascript%201386%201035%20%7B%0AsayIt%20%27Got%20OK%3A%27%20_eol%20_serbuffer%0A%7D%0A%0Ascript%20475%201111%20%7B%0Ato%20%27_handleIPD%27%20%7B%7D%0A%7D%0A%0A "here").
